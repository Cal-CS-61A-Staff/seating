{% extends 'base.html.j2' %}
{% import 'macros.html.j2' as macros with context %}

{% block title %}Students | {{ super() }}{% endblock %}

{% block body %}
<section id="student-table" class="students mdl-grid">
  <div class="mdl-cell mdl-cell--12-col">
    <h4>Students</h4>
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable">
      <label class="mdl-button mdl-js-button mdl-button--icon" for="search">
        <i class="material-icons">search</i>
      </label>
      <div class="mdl-textfield__expandable-holder">
        <input class="search mdl-textfield__input" type="text" id="search">
        <label class="mdl-textfield__label" for="search-expandable">Search</label>
      </div>
    </div>
    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
      <thead>
        <tr>
          <th class="sort mdl-data-table__cell--non-numeric" data-sort="name">Name</th>
          <th class="sort mdl-data-table__cell--non-numeric" data-sort="assignment">Seat</th>
        </tr>
      </thead>
      <tbody class="list">
        {% for student in exam.students %}
        <tr>
          <td class="mdl-data-table__cell--non-numeric">
            <a class="name" href="{{ url_for('student', exam=exam, email=student.email) }}">
              {{ student.name }}
            </a>
          </td>
          <td class="mdl-data-table__cell--non-numeric">
          {% if student.assignment %}
            {% set seat = student.assignment.seat %}
            <a class="assignment" href="{{ url_for('room', exam=exam, name=seat.room.name, seat=seat.name) }}">
              {{ seat.room.display_name }} {{ seat.name }}
            </a>
          {% else %}
            <span class="assignment">&mdash;</span>
          {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script>
var options = {
  valueNames: ['name', 'email', 'sid', 'assignment']
};

var studentTable = new List('student-table', options);
studentTable.sort('name');
document.getElementById('search').focus();
</script>
{% endblock %}
